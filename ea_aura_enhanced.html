<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EA Aura - Enhanced Wellness Hub</title>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
            padding: 10px;
        }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            min-height: 100vh;
        }

        .app-container {
            background: #ffffff;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            text-align: center;
            position: relative;
        }

        .logo {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .coin-jar {
            position: absolute;
            top: 15px;
            right: 30px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .coin-jar:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .coin-count {
            font-size: 1.2em;
            font-weight: bold;
        }

        .tab-navigation {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .tab-btn {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            color: #666;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab-btn:hover {
            background: #e9ecef;
            color: #333;
        }

        .tab-btn.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: #ffffff;
        }

        .tab-content {
            padding: 30px;
            min-height: 500px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        /* Genie Character Sidebar */
        .genie-sidebar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 20px;
            color: white;
            position: sticky;
            top: 10px;
            height: fit-content;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .genie-character {
            text-align: center;
            margin-bottom: 20px;
        }

        .genie-avatar {
            width: 140px;
            height: 180px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            margin: 0 auto 15px;
            animation: float 3s ease-in-out infinite;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            border: 4px solid white;
            overflow: hidden;
        }

        .genie-avatar:hover {
            transform: scale(1.1);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .voice-character-card:hover {
            transform: scale(1.03) !important;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        /* Coin Jar Animations */
        @keyframes coinDrop {
            0% { 
                transform: translateY(-100px) scale(1.5) rotate(0deg);
                opacity: 1;
            }
            50% {
                transform: translateY(-20px) scale(1.2) rotate(180deg);
                opacity: 0.8;
            }
            100% { 
                transform: translateY(150px) scale(0.8) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes jarShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-3px); }
            75% { transform: translateX(3px); }
        }

        @keyframes jarGlow {
            0% { filter: drop-shadow(0 0 5px rgba(102, 126, 234, 0.3)); }
            50% { filter: drop-shadow(0 0 20px rgba(102, 126, 234, 0.6)); }
            100% { filter: drop-shadow(0 0 5px rgba(102, 126, 234, 0.3)); }
        }

        .flying-coin {
            position: absolute;
            width: 30px;
            height: 30px;
            background: url('coin.png') center/cover;
            border-radius: 50%;
            pointer-events: none;
            z-index: 10;
            animation: coinDrop 1.5s ease-in forwards;
        }

        .jar-shake {
            animation: jarShake 0.6s ease-in-out;
        }

        .jar-glow {
            animation: jarGlow 1s ease-in-out;
        }

        .genie-name {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .genie-role {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .genie-chat {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            min-height: 200px;
            max-height: 300px;
            overflow-y: auto;
        }

        .genie-message {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 10px;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .genie-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 10px 15px;
            color: white;
            outline: none;
            font-size: 0.9em;
        }

        .genie-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        /* Wellness Dashboard Styles */
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .metric-card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .metric-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
            background: none;
            border: none;
            text-align: center;
            color: #333;
            width: 100%;
            outline: none;
        }

        .metric-value:focus {
            background: #ffffff;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 5px;
        }

        .metric-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* Games Tab Styles */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .game-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .game-card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .game-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .game-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .game-description {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
        }

        .play-button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .play-button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        /* Wealth Tab Styles */
        .wealth-section {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            color: #333;
        }

        .wealth-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .coin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .coin-stat {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .coin-stat-value {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .coin-stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* Help Resources */
        .help-resources {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .help-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .help-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .help-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .help-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .help-description {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
        }

        .help-link {
            display: inline-block;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .help-link:hover {
            transform: scale(1.05);
        }

        /* Coin Animation */
        .coin-animation {
            position: fixed;
            font-size: 2em;
            color: #ffd700;
            pointer-events: none;
            z-index: 1000;
            animation: coinFly 2s ease-out forwards;
        }

        @keyframes coinFly {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            50% {
                transform: translateY(-50px) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(0.5);
            }
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .genie-sidebar {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .tab-navigation {
                flex-wrap: wrap;
            }
            
            .tab-btn {
                min-width: 50%;
            }
            
            .metric-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
            }
        }

        /* Journal Tab Styles */
        .mood-btn {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            padding: 10px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            font-weight: 500;
        }

        .mood-btn:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .mood-btn.selected {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .gratitude-input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .reflection-input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .prompt-card:hover {
            background: rgba(255,255,255,0.5) !important;
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .journal-entry {
            transition: all 0.3s ease;
        }

        .journal-entry:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Main App Container -->
        <div class="app-container">
            <!-- Header -->
            <div class="header">
                <div class="logo" style="display: flex; align-items: center; justify-content: center;">
                    <img src="Aura_Logo.png" alt="EA Aura" style="height: 70px; width: auto;" onerror="this.outerHTML='<span>❤️</span>';">
                </div>
            </div>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" onclick="switchTab('wellness')">❤️ Wellness</button>
                <button class="tab-btn" onclick="switchTab('wealth')">🪙 Wealth</button>
                <button class="tab-btn" onclick="switchTab('journal')">📝 Journal</button>
                <button class="tab-btn" onclick="switchTab('games')">🎮 Games</button>
                <button class="tab-btn" onclick="switchTab('reports')">📊 Reports</button>
                <button class="tab-btn" onclick="switchTab('help')">❓ Help and Settings</button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Wellness Tab -->
                <div class="tab-panel active" id="wellness-tab">
                    <h2 style="margin-bottom: 20px;">📈 Your Wellness Dashboard</h2>
                    
                    <div class="metric-grid">
                        <div class="metric-card" onclick="addCoins(10, event)">
                            <input type="text" class="metric-value" id="todaySteps" value="8247" placeholder="Enter steps">
                            <div class="metric-label">Steps Today</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="stepsProgress" style="width: 82%; background: linear-gradient(45deg, #2ecc71, #27ae60);"></div>
                            </div>
                        </div>
                        
                        <div class="metric-card" onclick="addCoins(15, event)">
                            <input type="text" class="metric-value" id="todaySleep" value="7.2" placeholder="Hours">
                            <div class="metric-label">Sleep Last Night (hours)</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="sleepProgress" style="width: 90%; background: linear-gradient(45deg, #3498db, #2980b9);"></div>
                            </div>
                        </div>
                        
                        <div class="metric-card" onclick="addCoins(5, event)">
                            <input type="number" class="metric-value" id="todayMood" value="9" min="1" max="10" placeholder="1-10">
                            <div class="metric-label">Mood Score (1-10)</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="moodProgress" style="width: 90%; background: linear-gradient(45deg, #f39c12, #e67e22);"></div>
                            </div>
                        </div>
                        
                        <div class="metric-card" onclick="addCoins(20, event)">
                            <input type="number" class="metric-value" id="todayFocus" value="145" placeholder="Minutes">
                            <div class="metric-label">Focus Time (minutes)</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="focusProgress" style="width: 72%; background: linear-gradient(45deg, #9b59b6, #8e44ad);"></div>
                            </div>
                        </div>
                    </div>

                    <div style="background: #fff3cd; border-radius: 15px; padding: 20px; border: 1px solid #ffc107; margin-bottom: 20px;">
                        <h3 style="color: #856404; margin-bottom: 10px;">✨ Quote of the Day</h3>
                        <p id="dailyQuote" style="line-height: 1.6; color: #333; font-style: italic; font-size: 1.1em;">
                            "The groundwork for all happiness is good health." - Leigh Hunt
                        </p>
                        <small style="color: #666; font-size: 0.9em;">🔄 Refresh the page for a new inspirational quote!</small>
                    </div>

                    <div style="background: #e8f0ff; border-radius: 15px; padding: 20px; border: 1px solid #667eea;">
                        <h3 style="color: #667eea; margin-bottom: 10px;">🤖 AI Insights</h3>
                        <p id="aiInsight" style="line-height: 1.5; color: #333;">
                            Great job! Your focus time increased 15% this week. Try the Pomodoro technique for even better concentration. Your sleep quality is excellent - keep that bedtime routine! 🎯
                        </p>
                    </div>

                    <!-- Animated Coin Jar Section -->
                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 25px; margin-top: 25px; align-items: center;">
                        <!-- Coin Jar Animation -->
                        <div style="text-align: center; position: relative;">
                            <div id="coinJarContainer" style="position: relative; display: inline-block;">
                                <img id="coinJarImage" src="Jar.png" alt="Wellness Coin Jar" 
                                     style="width: 200px; height: auto; transition: all 0.3s ease;" 
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                <div style="display: none; font-size: 4em; color: #667eea;">🏺</div>
                                
                                <!-- Coin Count Display -->
                                <div id="jarCoinCount" style="position: absolute; bottom: -25px; left: 50%; transform: translateX(-50%); background: linear-gradient(45deg, #ffd700, #ffed4e); color: #8b7d00; padding: 8px 16px; border-radius: 20px; font-weight: bold; font-size: 1.1em; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3); border: 2px solid #ffd700;">
                                    1,247 Coins
                                </div>
                                
                                <!-- Flying Coins Container -->
                                <div id="flyingCoinsContainer" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;"></div>
                            </div>
                        </div>

                        <!-- Play It Forward Message -->
                        <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 20px; padding: 25px; position: relative; overflow: hidden;">
                            <div style="position: absolute; top: -10px; right: -10px; width: 60px; height: 60px; background: rgba(255,255,255,0.1); border-radius: 50%; opacity: 0.5;"></div>
                            <div style="position: absolute; bottom: -20px; left: -20px; width: 80px; height: 80px; background: rgba(255,255,255,0.1); border-radius: 50%; opacity: 0.3;"></div>
                            
                            <h3 style="margin-bottom: 15px; color: white; position: relative; z-index: 2;">
                                🎯 Wellness Rewards
                            </h3>
                            <p style="margin-bottom: 20px; font-size: 1.1em; line-height: 1.6; position: relative; z-index: 2; opacity: 0.95;">
                                Fill the jar to earn <strong>Play It Forward</strong> points! Every wellness activity adds coins to your jar and contributes to your overall wellbeing score.
                            </p>
                            
                            <div style="display: flex; gap: 15px; flex-wrap: wrap; position: relative; z-index: 2;">
                                <a href="https://playitforward.work.ea.com/" target="_blank" 
                                   style="background: rgba(255,255,255,0.2); color: white; text-decoration: none; padding: 12px 20px; border-radius: 25px; font-weight: 600; transition: all 0.3s ease; border: 2px solid rgba(255,255,255,0.3); display: inline-flex; align-items: center; gap: 8px;">
                                    🚀 Visit Play It Forward
                                </a>
                                <button onclick="showJarProgress()" 
                                        style="background: rgba(255,255,255,0.15); color: white; border: 2px solid rgba(255,255,255,0.3); padding: 12px 20px; border-radius: 25px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                                    📊 View Progress
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Wealth Tab -->
                <div class="tab-panel" id="wealth-tab">
                    <div class="wealth-section">
                        <div class="wealth-title">💰 Financial Wellness Resources</div>
                        <p style="text-align: center; margin-bottom: 20px; opacity: 0.9;">Access your comprehensive financial planning tools</p>
                    </div>

                    <div style="background: #f8f9fa; border-radius: 15px; padding: 30px; margin-bottom: 20px; text-align: center;">
                        <h3 style="margin-bottom: 20px; color: #007acc;">📊 EA Financial Wellness Template</h3>
                        <p style="margin-bottom: 20px; color: #666; font-size: 1.1em;">Download our comprehensive Excel-based financial planning template designed specifically for EA employees</p>
                        
                        <div style="background: #e8f5e8; border-radius: 12px; padding: 20px; margin-bottom: 25px; text-align: left;">
                            <h4 style="color: #28a745; margin-bottom: 15px; text-align: center;">✅ What's Included:</h4>
                            <div style="color: #333; line-height: 1.8;">
                                <div style="margin-bottom: 15px;">
                                    <p style="margin-bottom: 8px;"><strong>🥧 Sheet 1 – Wealth Summary</strong></p>
                                    <ul style="margin: 0 0 0 30px;">
                                        <li>Expense, Savings, Investments, Insurance tracking</li>
                                        <li>Suggested allocation percentages (50/20/20/10 split)</li>
                                        <li>Built-in formulas and automated calculations</li>
                                    </ul>
                                </div>
                                
                                <div>
                                    <p style="margin-bottom: 8px;"><strong>💡 Sheet 2 – Financial Health Tips</strong></p>
                                    <ul style="margin: 0 0 0 30px;">
                                        <li>7 actionable financial wellness rules</li>
                                        <li>50-30-20 budgeting framework</li>
                                        <li>Emergency fund and investment strategies</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <button class="play-button" onclick="downloadExcelTemplate()" style="background: linear-gradient(45deg, #007acc, #0099cc); padding: 15px 30px; font-size: 1.1em;">
                            ⬇️ Download Excel Template
                        </button>
                        
                        <div style="margin-top: 15px; font-size: 0.9em; color: #666;">
                            ℹ️ Compatible with Excel 2016+ and Google Sheets
                        </div>
                    </div>
                </div>

                <!-- Journal Tab -->
                <div class="tab-panel" id="journal-tab">
                    <h2 style="margin-bottom: 20px;">📝 Wellness Journal</h2>
                    
                    <!-- Quick Stats -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 25px;">
                        <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold;" id="journalStreak">7</div>
                            <div style="font-size: 0.9em; opacity: 0.9;">Day Streak</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold;" id="totalEntries">23</div>
                            <div style="font-size: 0.9em; opacity: 0.9;">Total Entries</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold;" id="avgMoodScore">8.2</div>
                            <div style="font-size: 0.9em; opacity: 0.9;">Avg Mood</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #fa709a, #fee140); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold;" id="coinsEarned">340</div>
                            <div style="font-size: 0.9em; opacity: 0.9;">Coins Earned</div>
                        </div>
                    </div>

                    <!-- Today's Entry Section -->
                    <div style="background: #f8f9fa; border-radius: 20px; padding: 30px; margin-bottom: 25px; border: 2px solid #e9ecef;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="color: #333; margin: 0;">📅 Today's Entry</h3>
                            <span style="color: #666; font-size: 0.9em;" id="todayDate"></span>
                        </div>

                        <!-- Mood Selector -->
                        <div style="margin-bottom: 20px;">
                            <h4 style="color: #555; margin-bottom: 10px;">🎭 How are you feeling today?</h4>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="mood-btn" data-mood="5" onclick="selectMood(5, this)">😁 Amazing</button>
                                <button class="mood-btn" data-mood="4" onclick="selectMood(4, this)">😊 Great</button>
                                <button class="mood-btn" data-mood="3" onclick="selectMood(3, this)">🙂 Good</button>
                                <button class="mood-btn" data-mood="2" onclick="selectMood(2, this)">😐 Okay</button>
                                <button class="mood-btn" data-mood="1" onclick="selectMood(1, this)">😟 Tough</button>
                            </div>
                        </div>

                        <!-- Gratitude Section -->
                        <div style="margin-bottom: 20px;">
                            <h4 style="color: #555; margin-bottom: 10px;">🙏 Three things I'm grateful for:</h4>
                            <div style="display: grid; gap: 10px;">
                                <input type="text" class="gratitude-input" placeholder="1. Something that made you smile today..." style="padding: 12px; border: 2px solid #e9ecef; border-radius: 10px; font-size: 1em;">
                                <input type="text" class="gratitude-input" placeholder="2. A person who positively impacted your day..." style="padding: 12px; border: 2px solid #e9ecef; border-radius: 10px; font-size: 1em;">
                                <input type="text" class="gratitude-input" placeholder="3. An accomplishment or moment of growth..." style="padding: 12px; border: 2px solid #e9ecef; border-radius: 10px; font-size: 1em;">
                            </div>
                        </div>

                        <!-- Reflection Prompts -->
                        <div style="margin-bottom: 20px;">
                            <h4 style="color: #555; margin-bottom: 15px;">💭 Quick Reflection</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                                <div style="background: #fff; padding: 15px; border-radius: 10px; border: 1px solid #e9ecef;">
                                    <label style="display: block; font-weight: 500; margin-bottom: 8px; color: #333;">🎯 Today's biggest win:</label>
                                    <textarea class="reflection-input" id="todayWin" placeholder="What achievement are you most proud of today?" style="width: 100%; height: 80px; border: 1px solid #ddd; border-radius: 8px; padding: 10px; resize: vertical;"></textarea>
                                </div>
                                <div style="background: #fff; padding: 15px; border-radius: 10px; border: 1px solid #e9ecef;">
                                    <label style="display: block; font-weight: 500; margin-bottom: 8px; color: #333;">📚 Lesson learned:</label>
                                    <textarea class="reflection-input" id="lessonLearned" placeholder="What insight or lesson did you gain?" style="width: 100%; height: 80px; border: 1px solid #ddd; border-radius: 8px; padding: 10px; resize: vertical;"></textarea>
                                </div>
                                <div style="background: #fff; padding: 15px; border-radius: 10px; border: 1px solid #e9ecef;">
                                    <label style="display: block; font-weight: 500; margin-bottom: 8px; color: #333;">🌟 Tomorrow's focus:</label>
                                    <textarea class="reflection-input" id="tomorrowFocus" placeholder="What's your main priority for tomorrow?" style="width: 100%; height: 80px; border: 1px solid #ddd; border-radius: 8px; padding: 10px; resize: vertical;"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Save Entry Button -->
                        <div style="text-align: center; margin-top: 25px;">
                            <button onclick="saveJournalEntry()" style="background: linear-gradient(45deg, #667eea, #764ba2); color: white; border: none; padding: 15px 40px; border-radius: 25px; font-size: 1.1em; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); transition: all 0.3s ease;">
                                💾 Save Today's Entry
                            </button>
                        </div>
                    </div>

                    <!-- Journal Prompts -->
                    <div style="background: linear-gradient(135deg, #ffeaa7, #fab1a0); border-radius: 20px; padding: 25px; margin-bottom: 25px;">
                        <h3 style="color: #333; margin-bottom: 20px; text-align: center;">💡 Daily Wellness Prompts</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">
                            <div class="prompt-card" style="background: rgba(255,255,255,0.3); padding: 15px; border-radius: 12px; cursor: pointer; transition: all 0.3s ease;" onclick="usePrompt(this)">
                                <h5 style="color: #2d3748; margin-bottom: 8px;">🧘 Mindfulness Check</h5>
                                <p style="color: #4a5568; font-size: 0.9em; margin: 0;">"What sensations do I notice in my body right now?"</p>
                            </div>
                            <div class="prompt-card" style="background: rgba(255,255,255,0.3); padding: 15px; border-radius: 12px; cursor: pointer; transition: all 0.3s ease;" onclick="usePrompt(this)">
                                <h5 style="color: #2d3748; margin-bottom: 8px;">🎯 Goal Reflection</h5>
                                <p style="color: #4a5568; font-size: 0.9em; margin: 0;">"How did I move closer to my wellness goals today?"</p>
                            </div>
                            <div class="prompt-card" style="background: rgba(255,255,255,0.3); padding: 15px; border-radius: 12px; cursor: pointer; transition: all 0.3s ease;" onclick="usePrompt(this)">
                                <h5 style="color: #2d3748; margin-bottom: 8px;">❤️ Self-Compassion</h5>
                                <p style="color: #4a5568; font-size: 0.9em; margin: 0;">"What would I tell a friend who had my day?"</p>
                            </div>
                            <div class="prompt-card" style="background: rgba(255,255,255,0.3); padding: 15px; border-radius: 12px; cursor: pointer; transition: all 0.3s ease;" onclick="usePrompt(this)">
                                <h5 style="color: #2d3748; margin-bottom: 8px;">🌱 Growth Mindset</h5>
                                <p style="color: #4a5568; font-size: 0.9em; margin: 0;">"What challenge helped me grow today?"</p>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Entries -->
                    <div style="background: #fff; border-radius: 20px; padding: 25px; border: 2px solid #e9ecef;">
                        <h3 style="color: #333; margin-bottom: 20px;">📖 Recent Entries</h3>
                        <div id="recentEntries" style="display: grid; gap: 15px;">
                            <!-- Sample entries will be populated by JavaScript -->
                            <div class="journal-entry" style="background: #f8f9fa; padding: 20px; border-radius: 12px; border-left: 4px solid #667eea;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span style="font-weight: bold; color: #333;">November 12, 2025</span>
                                    <span style="font-size: 1.5em;">😊</span>
                                </div>
                                <p style="color: #555; margin-bottom: 8px; font-style: italic;">"Grateful for completing the wellness tracker project and helping the team stay healthy!"</p>
                                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                    <span style="background: #e2e8f0; color: #4a5568; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">#productivity</span>
                                    <span style="background: #e2e8f0; color: #4a5568; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">#teamwork</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                
                <div class="tab-panel" id="games-tab">
                    <h2 style="margin-bottom: 20px;">🎮 Web Wellness Games</h2>
                    
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 20px; border-radius: 15px; margin-bottom: 25px; border: 2px solid rgba(76, 175, 80, 0.3);">
                        <h3 style="color: #4CAF50; margin-bottom: 15px;">🚀 New: Browser-Based Games!</h3>
                        <p style="margin: 0; color: #333; font-size: 1.1rem;">
                            <strong>No Python installation required!</strong> All games now run directly in your web browser. 
                            Play instantly on any device - desktop, tablet, or mobile.
                        </p>
                    </div>
                    
                    <div class="games-grid">
                        <div class="game-card">
                            <div class="game-icon">🌱</div>
                            <div class="game-title">Wellness Snake</div>
                            <div class="game-description">Focus training with breathing exercises. Classic gameplay enhanced with mindfulness features.</div>
                            <button class="play-button" onclick="openWebGame('games/wellness_snake.html')">
                                ▶️ Play Focus Training
                            </button>
                        </div>
                        
                        <div class="game-card">
                            <div class="game-icon">🧠</div>
                            <div class="game-title">Memory Cards</div>
                            <div class="game-description">Cognitive enhancement through memory matching. Multiple difficulty levels with streak bonuses.</div>
                            <button class="play-button" onclick="openWebGame('games/memory_cards.html')">
                                ▶️ Enhance Memory
                            </button>
                        </div>
                        
                        <div class="game-card">
                            <div class="game-icon">🧩</div>
                            <div class="game-title">Sudoku</div>
                            <div class="game-description">Logic and problem-solving challenges. Features hint system and multiple difficulty levels.</div>
                            <button class="play-button" onclick="openWebGame('games/sudoku_puzzle.html')">
                                ▶️ Solve Puzzles
                            </button>
                        </div>
                        
                        <div class="game-card">
                            <div class="game-icon">🌸</div>
                            <div class="game-title">Zen Garden</div>
                            <div class="game-description">Digital meditation through mindful raking. Includes breathing exercises and relaxation features.</div>
                            <button class="play-button" onclick="openWebGame('games/zen_garden.html')">
                                ▶️ Find Peace
                            </button>
                        </div>
                        
                        <div class="game-card">
                            <div class="game-icon">🚀</div>
                            <div class="game-title">Game Launcher Hub</div>
                            <div class="game-description">Access all games in one place with progress tracking and detailed wellness benefits.</div>
                            <button class="play-button" onclick="openWebGame('games/index.html')" style="background: linear-gradient(45deg, #667eea, #764ba2);">
                                🚀 Launch Game Hub
                            </button>
                        </div>
                        
                        <div style="grid-column: 1 / -1; background: #e8f5e8; padding: 20px; border-radius: 15px; margin-top: 25px; text-align: center;">
                            <h4 style="color: #2e7d32; margin-bottom: 15px;">ℹ️ Game Features</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; text-align: left;">
                                <div><strong>🌐 Browser-Based:</strong> No downloads required</div>
                                <div><strong>📱 Mobile-Friendly:</strong> Works on all devices</div>
                                <div><strong>🪙 Coin Integration:</strong> Earn wellness coins</div>
                                <div><strong>🧘 Mindfulness:</strong> Built-in breathing exercises</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reports Tab -->
                <div class="tab-panel" id="reports-tab">
                    <h2 style="margin-bottom: 25px;">📊 Wellness Reports & Data</h2>
                    
                    <!-- Data Export Section -->
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 20px; padding: 25px; margin-bottom: 30px;">
                        <h3 style="margin-bottom: 15px; color: white;">📥 Export Your Data</h3>
                        <p style="margin-bottom: 20px; opacity: 0.9;">Download your wellness and journal data for personal tracking or sharing with healthcare providers.</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                            <button class="play-button" onclick="downloadWellnessCSV()" style="background: rgba(255,255,255,0.2); border: 2px solid white; color: white;">
                                📊 Wellness Data (CSV)
                            </button>
                            <button class="play-button" onclick="downloadJournalCSV()" style="background: rgba(255,255,255,0.2); border: 2px solid white; color: white;">
                                📝 Journal Entries (CSV)
                            </button>
                        </div>
                    </div>

                    <!-- Wellness Data Table -->
                    <div style="background: #fff; border-radius: 20px; padding: 25px; margin-bottom: 25px; border: 2px solid #e9ecef;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="color: #333; margin: 0;">📈 Wellness Tracking History</h3>
                            <div style="display: flex; gap: 10px;">
                                <select id="wellnessTimeFilter" onchange="filterWellnessData()" style="padding: 8px; border-radius: 8px; border: 1px solid #ddd;">
                                    <option value="7">Last 7 days</option>
                                    <option value="30" selected>Last 30 days</option>
                                    <option value="90">Last 90 days</option>
                                    <option value="all">All time</option>
                                </select>
                                <button onclick="refreshWellnessData()" style="background: #667eea; color: white; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer;">🔄 Refresh</button>
                            </div>
                        </div>
                        
                        <div style="overflow-x: auto;">
                            <table id="wellnessDataTable" style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, #f8f9fa, #e9ecef);">
                                        <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; font-weight: 600; color: #333;">📅 Date</th>
                                        <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; font-weight: 600; color: #333;">🚶‍♂️ Steps</th>
                                        <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; font-weight: 600; color: #333;">😴 Sleep (hrs)</th>
                                        <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; font-weight: 600; color: #333;">😊 Mood</th>
                                        <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; font-weight: 600; color: #333;">🎯 Focus (min)</th>
                                        <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; font-weight: 600; color: #333;">🪙 Coins</th>
                                    </tr>
                                </thead>
                                <tbody id="wellnessTableBody">
                                    <tr>
                                        <td colspan="6" style="padding: 20px; text-align: center; color: #666; font-style: italic;">Loading wellness data...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Summary Statistics -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                        <div style="background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; border-radius: 15px; padding: 20px; text-align: center;">
                            <h4 style="margin-bottom: 10px; color: white;">📈 30-Day Averages</h4>
                            <div id="monthlyAverages" style="line-height: 1.8;">
                                <div>🚶‍♂️ Steps: <strong id="avgSteps">8,234</strong></div>
                                <div>😴 Sleep: <strong id="avgSleep">7.3 hrs</strong></div>
                                <div>😊 Mood: <strong id="avgMood">8.2/10</strong></div>
                                <div>🎯 Focus: <strong id="avgFocus">145 min</strong></div>
                            </div>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; border-radius: 15px; padding: 20px; text-align: center;">
                            <h4 style="margin-bottom: 10px; color: white;">🎯 Goals Achievement</h4>
                            <div id="goalsProgress" style="line-height: 1.8;">
                                <div>📊 Steps Goal: <strong id="stepsGoalRate">86%</strong></div>
                                <div>💤 Sleep Goal: <strong id="sleepGoalRate">92%</strong></div>
                                <div>😊 Mood Goal: <strong id="moodGoalRate">95%</strong></div>
                                <div>⏰ Focus Goal: <strong id="focusGoalRate">78%</strong></div>
                            </div>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #f39c12, #e67e22); color: white; border-radius: 15px; padding: 20px; text-align: center;">
                            <h4 style="margin-bottom: 10px; color: white;">🏆 Personal Records</h4>
                            <div id="personalRecords" style="line-height: 1.8;">
                                <div>📈 Best Steps: <strong id="maxSteps">12,450</strong></div>
                                <div>😴 Best Sleep: <strong id="maxSleep">9.2 hrs</strong></div>
                                <div>� Best Mood: <strong id="maxMood">10/10</strong></div>
                                <div>⚡ Best Focus: <strong id="maxFocus">240 min</strong></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Help Tab -->
                <div class="tab-panel" id="help-tab">
                    <div class="help-resources">
                        <div class="help-card">
                            <div class="help-icon">🏥</div>
                            <div class="help-title">EA Mental Wellbeing Resources</div>
                            <div class="help-description">Access comprehensive mental health support, wellness programs, and confidential resources designed specifically for EA employees worldwide.</div>
                            <a href="https://eaworld.work.ea.com/benefits-global-perks-and-benefits/mental-wellbeing" target="_blank" class="help-link">Access EA Wellbeing</a>
                        </div>
                        
                        <div class="help-card">
                            <div class="help-icon">🏥</div>
                            <div class="help-title">MediBuddy Health Benefits</div>
                            <div class="help-description">Complete healthcare solution for EA employees. Book health checkups, buy medicines, consult doctors online, and access your insurance benefits.</div>
                            <a href="https://www.medibuddy.in/" target="_blank" class="help-link">Visit MediBuddy</a>
                        </div>
                        
                        <div class="help-card">
                            <div class="help-icon">🍎</div>
                            <div class="help-title">Food Book</div>
                            <div class="help-description">Comprehensive nutrition guidance, meal planning, and healthy eating tips for optimal performance.</div>
                            <a href="https://play.google.com/store/apps/details?id=com.thesmartq.compass.foodbook&hl=en_IN" target="_blank" class="help-link">Get Food Book</a>
                        </div>
                        
                        <div class="help-card">
                            <div class="help-icon">💪</div>
                            <div class="help-title">Fitness Resources</div>
                            <div class="help-description">Exercise routines, wellness videos, and movement strategies designed for game developers and office workers.</div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-top: 15px;">
                                <a href="https://youtu.be/FjFFasD3kr0?si=rSL61cpLCziOPvOC" target="_blank" class="help-link" style="font-size: 0.85em; padding: 8px 12px;">🧘 Yoga</a>
                                <a href="https://youtu.be/cbKkB3POqaY?si=EajVb1jidAX6U3Ce" target="_blank" class="help-link" style="font-size: 0.85em; padding: 8px 12px;">🏠 Home Workout</a>
                                <a href="https://youtu.be/k0PSUDvLi8E?si=B2phvxa4QFx2m9dG" target="_blank" class="help-link" style="font-size: 0.85em; padding: 8px 12px;">🧘‍♀️ Meditation</a>
                                <a href="https://youtu.be/o5soep1e8Ik?si=YigpdDUzSUwneT9s" target="_blank" class="help-link" style="font-size: 0.85em; padding: 8px 12px;">💃 Zumba</a>
                            </div>
                        </div>
                    </div>

                    <!-- EA Health Insurance & Benefits Section -->
                    <div style="background: linear-gradient(135deg, #28a745, #20c997); color: white; border-radius: 20px; padding: 25px; margin: 25px 0;">
                        <div style="display: flex; align-items: center; margin-bottom: 20px;">
                            <span style="font-size: 2.5em; margin-right: 15px;">🏥</span>
                            <div>
                                <h3 style="color: white; margin: 0;">EA Health Insurance & MediBuddy Benefits</h3>
                                <p style="margin: 5px 0 0 0; opacity: 0.9;">Complete healthcare coverage for all EA employees</p>
                            </div>
                        </div>

                        <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                            <h4 style="color: white; margin-bottom: 15px;">🎯 Available Benefits</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                                    <h5 style="color: white; margin-bottom: 8px;">🔬 Health Checkups</h5>
                                    <p style="margin: 0; font-size: 0.9em; opacity: 0.9;">Comprehensive annual health checkups covered under your insurance plan</p>
                                </div>
                                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                                    <h5 style="color: white; margin-bottom: 8px;">💊 Medicine Purchase</h5>
                                    <p style="margin: 0; font-size: 0.9em; opacity: 0.9;">Buy medicines online with insurance coverage through MediBuddy</p>
                                </div>
                                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                                    <h5 style="color: white; margin-bottom: 8px;">👨‍⚕️ Online Consultations</h5>
                                    <p style="margin: 0; font-size: 0.9em; opacity: 0.9;">24/7 doctor consultations available through the MediBuddy platform</p>
                                </div>
                                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                                    <h5 style="color: white; margin-bottom: 8px;">🏥 Hospitalization</h5>
                                    <p style="margin: 0; font-size: 0.9em; opacity: 0.9;">Complete hospitalization coverage with cashless treatment facilities</p>
                                </div>
                            </div>
                        </div>

                        <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 20px;">
                            <h4 style="color: white; margin-bottom: 15px;">📞 Insurance Support Contacts</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; font-size: 0.9em;">
                                <div>
                                    <h5 style="color: white; margin-bottom: 10px;">🏥 Medi Assist (Claims & Queries)</h5>
                                    <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 8px;">
                                        <p style="margin: 2px 0;"><strong>📧</strong> shaik.rowfani@mediassist.in</p>
                                        <p style="margin: 2px 0;"><strong>📱</strong> 7795702707</p>
                                        <p style="margin: 2px 0; font-size: 0.85em; opacity: 0.8;">Mr. Shaik Rowafi - First Point of Contact</p>
                                    </div>
                                </div>
                                <div>
                                    <h5 style="color: white; margin-bottom: 10px;">🛡️ Marsh India Insurance</h5>
                                    <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 8px;">
                                        <p style="margin: 2px 0;"><strong>📧</strong> Shravani.Paravasthu@marsh.com</p>
                                        <p style="margin: 2px 0;"><strong>📱</strong> 865597630</p>
                                        <p style="margin: 2px 0; font-size: 0.85em; opacity: 0.8;">Ms. Shravani - Policy Support</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="background: #e8f0ff; border-radius: 15px; padding: 20px; margin-top: 20px;">
                        <h3 style="color: #667eea; margin-bottom: 15px;">ℹ️ How to Use EA Aura Enhanced</h3>
                        <div style="color: #333; line-height: 1.6;">
                            <p><strong>❤️ Wellness Tab:</strong> Track your daily metrics and earn coins for staying healthy!</p>
                            <p><strong>💰 Wealth Tab:</strong> View your wellness coins and achievements</p>
                            <p><strong>🎮 Games Tab:</strong> Play web-based wellness games that boost cognitive health</p>
                            <p><strong>📊 Reports Tab:</strong> Export and analyze your wellness data</p>
                            <p><strong>🤖 Aura AI Assistant:</strong> Voice-enabled AI coach with personalized wellness advice</p>
                        </div>
                    </div>
                    
                    <div style="background: #f0f8ff; border-radius: 15px; padding: 20px; margin-top: 20px;">
                        <h3 style="color: #4169e1; margin-bottom: 15px;">🔊 Aura Voice Settings</h3>
                        <div style="color: #333; line-height: 1.6;">
                            <h4 style="color: #1e3a8a; margin: 15px 0 10px 0;">🎵 Voice Characters</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                                <div class="voice-character-card" onclick="selectVoiceCharacter('nova')" id="nova-card"
                                     style="background: linear-gradient(135deg, #ff8c00, #ffa500); color: white; padding: 15px; border-radius: 15px; cursor: pointer; text-align: center; transition: all 0.3s ease; border: 3px solid transparent;">
                                    <div style="width: 90px; height: 90px; margin: 0 auto 12px auto; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.15); position: relative;">
                                        <img src="nova_orange.png" alt="Nova" style="width: 100%; height: 100%; object-fit: contain; scale: 0.8;" onerror="this.outerHTML='<div style=&quot;font-size: 2.5em;&quot;>🏃‍♀️</div>';">
                                    </div>
                                    <h5 style="margin: 0; font-size: 1.1em;">Nova</h5>
                                    <p style="margin: 5px 0 0 0; font-size: 0.85em; opacity: 0.9;">Habit Tracker</p>
                                </div>
                                <div class="voice-character-card" onclick="selectVoiceCharacter('veda')" id="veda-card"
                                     style="background: linear-gradient(135deg, #dc143c, #ff6347); color: white; padding: 15px; border-radius: 15px; cursor: pointer; text-align: center; transition: all 0.3s ease; border: 3px solid transparent;">
                                    <div style="width: 90px; height: 90px; margin: 0 auto 12px auto; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.15); position: relative;">
                                        <img src="veda_red.png" alt="Veda" style="width: 100%; height: 100%; object-fit: contain; scale: 0.8;" onerror="this.outerHTML='<div style=&quot;font-size: 2.5em;&quot;>💪</div>';">
                                    </div>
                                    <h5 style="margin: 0; font-size: 1.1em;">Veda</h5>
                                    <p style="margin: 5px 0 0 0; font-size: 0.85em; opacity: 0.9;">Focus & Energy</p>
                                </div>
                                <div class="voice-character-card" onclick="selectVoiceCharacter('kai')" id="kai-card"
                                     style="background: linear-gradient(135deg, #4169e1, #6495ed); color: white; padding: 15px; border-radius: 15px; cursor: pointer; text-align: center; transition: all 0.3s ease; border: 3px solid transparent;">
                                    <div style="width: 90px; height: 90px; margin: 0 auto 12px auto; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.15); position: relative;">
                                        <img src="kai_blue.png" alt="Kai" style="width: 100%; height: 100%; object-fit: contain; scale: 0.8;" onerror="this.outerHTML='<div style=&quot;font-size: 2.5em;&quot;>🧘‍♂️</div>';">
                                    </div>
                                    <h5 style="margin: 0; font-size: 1.1em;">Kai</h5>
                                    <p style="margin: 5px 0 0 0; font-size: 0.85em; opacity: 0.9;">Calm & Breath</p>
                                </div>
                                <div class="voice-character-card" onclick="selectVoiceCharacter('iris')" id="iris-card"
                                     style="background: linear-gradient(135deg, #228b22, #32cd32); color: white; padding: 15px; border-radius: 15px; cursor: pointer; text-align: center; transition: all 0.3s ease; border: 3px solid transparent;">
                                    <div style="width: 90px; height: 90px; margin: 0 auto 12px auto; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.15); position: relative;">
                                        <img src="iris_green.png" alt="Iris" style="width: 100%; height: 100%; object-fit: contain; scale: 0.8;" onerror="this.outerHTML='<div style=&quot;font-size: 2.5em;&quot;>🌿</div>';">
                                    </div>
                                    <h5 style="margin: 0; font-size: 1.1em;">Iris</h5>
                                    <p style="margin: 5px 0 0 0; font-size: 0.85em; opacity: 0.9;">Relax & Recover</p>
                                </div>
                            </div>
                            
                            <h4 style="color: #1e3a8a; margin: 15px 0 10px 0;">🎛️ Voice Controls</h4>
                            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                                <button onclick="toggleAuraVoice()" 
                                        style="background: #10b981; color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 14px;">
                                    🔊 Toggle Voice On/Off
                                </button>
                                <button onclick="testAuraVoiceInApp()" 
                                        style="background: #f59e0b; color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 14px;">
                                    ▶️ Test Voice
                                </button>
                            </div>
                            
                            <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">
                                ℹ️ Aura will speak responses when you interact with wellness metrics, games, and chat messages.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Aura AI Assistant Sidebar -->
        <div class="genie-sidebar">
            <div class="genie-character">
                <div class="genie-avatar" onclick="interactWithAura()">
                    <img src="Aura_Image.png" alt="Aura AI Assistant" style="width: 100%; height: 100%; object-fit: contain; border-radius: 16px;" onerror="this.outerHTML='&lt;div style=&quot;color: #667eea; font-size: 2rem; text-align: center; line-height: 1.2;&quot;&gt;AI&lt;br&gt;AURA&lt;/div&gt;';">
                </div>
                <div class="genie-name" id="genieName">Aura</div>
                <div class="genie-role">Your AI Wellness Assistant</div>
            </div>

            <div class="genie-chat" id="genieChat">
                <div class="genie-message">
                    🤖 Hello! I'm Aura, your AI wellness assistant. I've been trained on the EA Coaching Pillars to provide personalized wellness guidance. Click on any wellness metric to earn coins! 🪙
                </div>
                <div class="genie-message">
                    💡 I can help with goal setting, stress management, focus techniques, web gaming guidance, and much more. What would you like to explore today?
                </div>
                <div class="genie-message">
                    🔊 Tip: I can speak my responses! Try asking me something and I'll respond with voice feedback based on your selected voice preference.
                </div>
            </div>

            <div style="position: relative; display: flex; gap: 10px; align-items: center;">
                <input type="text" class="genie-input" id="genieInput" placeholder="Ask Aura anything about wellness..." onkeypress="handleGenieInput(event)" style="flex: 1;">
                <button id="speechButton" onclick="toggleSpeechRecognition()" 
                        style="background: #667eea; color: white; border: none; padding: 10px; border-radius: 50%; cursor: pointer; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; font-size: 1.2em; transition: all 0.3s ease;">
                    🎤
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentCoins = 1247;
        let todayCoins = 127;
        let weeklyCoins = 843;

        // Daily inspirational quotes for wellness
        const dailyQuotes = [
            "The groundwork for all happiness is good health. - Leigh Hunt",
            "To keep the body in good health is a duty... otherwise we shall not be able to keep our mind strong and clear. - Buddha",
            "Health is not about the weight you lose, but about the life you gain. - Dr. Josh Axe",
            "Take care of your body. It's the only place you have to live. - Jim Rohn",
            "A healthy outside starts from the inside. - Robert Urich",
            "The greatest wealth is health. - Virgil",
            "Your body can stand almost anything. It's your mind that you have to convince. - Unknown",
            "Wellness is the complete integration of body, mind, and spirit. - Greg Anderson",
            "The first wealth is health. - Ralph Waldo Emerson",
            "Happiness is the highest form of health. - Dalai Lama",
            "Health is a state of complete harmony of the body, mind and spirit. - B.K.S. Iyengar",
            "Prevention is better than cure. - Desiderius Erasmus",
            "Early to bed and early to rise makes a man healthy, wealthy, and wise. - Benjamin Franklin",
            "Exercise is king. Nutrition is queen. Put them together and you've got a kingdom. - Jack LaLanne",
            "The doctor of the future will give no medicines, but will interest his patients in the care of the human frame, in diet, and in the cause and prevention of disease. - Thomas Edison"
        ];

        // Journal functionality
        let journalData = {
            streak: 7,
            totalEntries: 23,
            avgMood: 8.2,
            coinsEarned: 340,
            selectedMood: null,
            todayEntry: null
        };

        // Initialize journal when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeJournal();
            initializeCharacterSystem();
            initializeSpeechRecognition();
        });
        
        function initializeCharacterSystem() {
            // Load saved character or default to Nova
            const savedCharacter = localStorage.getItem('selectedCharacter') || 'nova';
            selectVoiceCharacter(savedCharacter);
        }

        function initializeJournal() {
            // Set today's date
            const today = new Date().toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('todayDate').textContent = today;

            // Load saved journal data
            loadJournalData();
        }

        function selectMood(mood, element) {
            // Remove selected class from all mood buttons
            document.querySelectorAll('.mood-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Add selected class to clicked button
            element.classList.add('selected');
            journalData.selectedMood = mood;
            
            // Provide encouraging feedback
            const moodMessages = {
                5: "🌟 Amazing! You're radiating positive energy today!",
                4: "😊 Great to hear you're feeling fantastic!",
                3: "🙂 A good day is a gift. Embrace the positive moments!",
                2: "💙 It's okay to have neutral days. Be gentle with yourself.",
                1: "🤗 Tough days help us appreciate the good ones. You're stronger than you think."
            };
            
            updateAuraMessage(moodMessages[mood]);
            addCoins(mood * 2, null); // Award 2-10 coins based on mood
        }

        function usePrompt(promptElement) {
            const promptText = promptElement.querySelector('p').textContent;
            
            // Find an empty reflection textarea and fill it with the prompt
            const reflectionInputs = document.querySelectorAll('.reflection-input');
            for (let input of reflectionInputs) {
                if (!input.value.trim()) {
                    input.focus();
                    input.placeholder = promptText;
                    break;
                }
            }
            
            // Highlight the prompt card temporarily
            promptElement.style.background = 'rgba(102, 126, 234, 0.3)';
            setTimeout(() => {
                promptElement.style.background = 'rgba(255,255,255,0.3)';
            }, 1000);
            
            updateAuraMessage("💭 Great prompt choice! Reflection is a powerful tool for personal growth and wellness.");
            addCoins(5, null);
        }

        function saveJournalEntry() {
            // Validate that at least mood is selected
            if (!journalData.selectedMood) {
                alert('Please select your mood before saving your entry! 😊');
                return;
            }

            // Collect gratitude entries
            const gratitudeInputs = document.querySelectorAll('.gratitude-input');
            const gratitudeEntries = Array.from(gratitudeInputs).map(input => input.value.trim()).filter(val => val);

            // Collect reflection entries
            const todayWin = document.getElementById('todayWin').value.trim();
            const lessonLearned = document.getElementById('lessonLearned').value.trim();
            const tomorrowFocus = document.getElementById('tomorrowFocus').value.trim();

            // Create entry object
            const entry = {
                date: new Date().toDateString(),
                mood: journalData.selectedMood,
                gratitude: gratitudeEntries,
                reflections: {
                    win: todayWin,
                    lesson: lessonLearned,
                    focus: tomorrowFocus
                },
                timestamp: new Date().toISOString()
            };

            // Save to localStorage
            let savedEntries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
            savedEntries.unshift(entry); // Add to beginning of array
            localStorage.setItem('journalEntries', JSON.stringify(savedEntries.slice(0, 50))); // Keep only last 50 entries

            // Update journal stats
            journalData.totalEntries++;
            journalData.coinsEarned += 50;
            updateJournalStats();

            // Award coins for journaling
            addCoins(50, null);
            
            // Success message
            updateAuraMessage("📝 Wonderful! Your journal entry has been saved. Consistent journaling improves mental health and self-awareness. You've earned 50 wellness coins!");
            
            // Show success animation
            showSaveSuccess();
            
            // Clear form for next entry
            clearJournalForm();
        }

        function showSaveSuccess() {
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '✅ Saved Successfully!';
            button.style.background = 'linear-gradient(45deg, #28a745, #20c997)';
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.style.background = 'linear-gradient(45deg, #667eea, #764ba2)';
            }, 2000);
        }

        function clearJournalForm() {
            // Reset mood selection
            document.querySelectorAll('.mood-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            journalData.selectedMood = null;

            // Clear gratitude inputs
            document.querySelectorAll('.gratitude-input').forEach(input => {
                input.value = '';
            });

            // Clear reflection inputs
            document.querySelectorAll('.reflection-input').forEach(input => {
                input.value = '';
            });
        }

        function loadJournalData() {
            // Load from localStorage if available
            const saved = localStorage.getItem('journalData');
            if (saved) {
                const savedData = JSON.parse(saved);
                Object.assign(journalData, savedData);
            }
            
            updateJournalStats();
            loadRecentEntries();
        }

        function updateJournalStats() {
            document.getElementById('journalStreak').textContent = journalData.streak;
            document.getElementById('totalEntries').textContent = journalData.totalEntries;
            document.getElementById('avgMoodScore').textContent = journalData.avgMood;
            document.getElementById('coinsEarned').textContent = journalData.coinsEarned;
            
            // Save to localStorage
            localStorage.setItem('journalData', JSON.stringify(journalData));
        }

        function loadRecentEntries() {
            const savedEntries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
            const recentEntriesContainer = document.getElementById('recentEntries');
            
            // Clear existing sample entry
            recentEntriesContainer.innerHTML = '';
            
            if (savedEntries.length === 0) {
                // Show sample entry if no real entries
                recentEntriesContainer.innerHTML = `
                    <div class="journal-entry" style="background: #f8f9fa; padding: 20px; border-radius: 12px; border-left: 4px solid #667eea;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <span style="font-weight: bold; color: #333;">Start your journaling journey!</span>
                            <span style="font-size: 1.5em;">📝</span>
                        </div>
                        <p style="color: #555; margin-bottom: 8px; font-style: italic;">"Your first entry will appear here. Journaling is a powerful tool for self-reflection and mental wellness."</p>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <span style="background: #e2e8f0; color: #4a5568; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">#wellness</span>
                            <span style="background: #e2e8f0; color: #4a5568; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">#selfcare</span>
                        </div>
                    </div>
                `;
                return;
            }
            
            // Display recent entries
            savedEntries.slice(0, 5).forEach(entry => {
                const moodEmojis = {1: '😟', 2: '😐', 3: '🙂', 4: '😊', 5: '😁'};
                const entryElement = document.createElement('div');
                entryElement.className = 'journal-entry';
                entryElement.style.cssText = 'background: #f8f9fa; padding: 20px; border-radius: 12px; border-left: 4px solid #667eea;';
                
                entryElement.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span style="font-weight: bold; color: #333;">${new Date(entry.date).toLocaleDateString()}</span>
                        <span style="font-size: 1.5em;">${moodEmojis[entry.mood]}</span>
                    </div>
                    <p style="color: #555; margin-bottom: 8px; font-style: italic;">"${entry.reflections.win || entry.gratitude[0] || 'A day of reflection and growth.'}"</p>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <span style="background: #e2e8f0; color: #4a5568; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">#mood-${entry.mood}</span>
                        ${entry.gratitude.length > 0 ? '<span style="background: #e2e8f0; color: #4a5568; padding: 4px 8px; border-radius: 12px; font-size: 0.8em;">#gratitude</span>' : ''}
                    </div>
                `;
                
                recentEntriesContainer.appendChild(entryElement);
            });
        }

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab panels
            document.querySelectorAll('.tab-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab panel
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Add active class to clicked tab button
            event.target.classList.add('active');

            // Initialize journal when journal tab is opened
            if (tabName === 'journal') {
                setTimeout(initializeJournal, 100); // Small delay to ensure DOM is ready
                updateAuraMessage("📝 Welcome to your wellness journal! Consistent journaling improves mental health, emotional awareness, and personal growth. Start by selecting your mood for today!");
            }

            // Initialize reports when reports tab is opened
            if (tabName === 'reports') {
                setTimeout(() => {
                    loadWellnessDataFromStorage();
                    populateWellnessTable();
                    updateAuraMessage("📊 Reports loaded! Your wellness data is automatically saved when you update metrics. Download your progress as CSV files for tracking!");
                }, 100);
            }
        }

        // Coin system functionality
        function addCoins(amount, event) {
            currentCoins += amount;
            todayCoins += amount;
            weeklyCoins += amount;
            
            // Update displays (header coin count removed - now only jar shows coins)
            if (document.getElementById('totalCoins')) {
                document.getElementById('totalCoins').textContent = currentCoins.toLocaleString();
            }
            if (document.getElementById('todayCoins')) {
                document.getElementById('todayCoins').textContent = todayCoins;
            }
            if (document.getElementById('weeklyCoins')) {
                document.getElementById('weeklyCoins').textContent = weeklyCoins;
            }
            
            // Update jar coin count
            updateJarCoinCount();
            
            // Save wellness data when metrics are updated
            saveDailyWellnessData();
            
            // Play coin sound and animate jar
            playCoinSound();
            animateJarCoin(amount, event);
            
            // Update genie message
            updateGenieMessage('🎉 Great job! You earned ' + amount + ' coins! Keep up the excellent wellness work!');
        }

        function updateJarCoinCount() {
            const jarCoinDisplay = document.getElementById('jarCoinCount');
            if (jarCoinDisplay) {
                jarCoinDisplay.textContent = currentCoins.toLocaleString() + ' Coins';
                
                // Update jar image based on coin count
                updateJarImage();
            }
        }

        function updateJarImage() {
            const jarImage = document.getElementById('coinJarImage');
            if (jarImage && currentCoins > 500) {
                // Show jar with coins when user has collected enough
                jarImage.src = 'Aura_Jar_and_Coin.png';
            }
        }

        function animateJarCoin(amount, event) {
            const jarContainer = document.getElementById('coinJarContainer');
            const flyingCoinsContainer = document.getElementById('flyingCoinsContainer');
            
            if (!jarContainer || !flyingCoinsContainer) return;
            
            // Create multiple flying coins based on amount
            const coinCount = Math.min(Math.floor(amount / 5), 6); // Max 6 coins
            
            for (let i = 0; i < coinCount; i++) {
                setTimeout(() => {
                    createFlyingCoin(flyingCoinsContainer, i);
                }, i * 150);
            }
            
            // Shake and glow jar
            const jarImage = document.getElementById('coinJarImage');
            if (jarImage) {
                jarImage.classList.add('jar-shake', 'jar-glow');
                setTimeout(() => {
                    jarImage.classList.remove('jar-shake', 'jar-glow');
                }, 1000);
            }
        }

        function createFlyingCoin(container, index) {
            const coin = document.createElement('div');
            coin.className = 'flying-coin';
            
            // Random starting position from top
            coin.style.left = (30 + Math.random() * 40) + '%';
            coin.style.top = '-50px';
            
            // Slight delay for staggered effect
            coin.style.animationDelay = (index * 0.1) + 's';
            
            container.appendChild(coin);
            
            // Remove coin after animation
            setTimeout(() => {
                if (coin && coin.parentNode) {
                    coin.parentNode.removeChild(coin);
                }
            }, 1500);
        }

        function playCoinSound() {
            // Create audio context for coin sound effect
            if (typeof AudioContext !== 'undefined' || typeof webkitAudioContext !== 'undefined') {
                try {
                    const audioContext = new (AudioContext || webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.1);
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                } catch (e) {
                    // Fallback for browsers that don't support Web Audio API
                    console.log('Coin sound played (audio not available)');
                }
            }
        }

        function showJarProgress() {
            const currentLevel = Math.floor(currentCoins / 100);
            const nextMilestone = (currentLevel + 1) * 100;
            const progress = ((currentCoins % 100) / 100 * 100).toFixed(1);
            
            const message = `🏆 Jar Progress Report\n\n💰 Current Coins: ${currentCoins.toLocaleString()}\n🎯 Next Milestone: ${nextMilestone} coins\n📊 Progress: ${progress}%\n\n🌟 Keep filling your wellness jar!`;
            
            updateAuraMessage(message);
        }

        // Save daily wellness data to localStorage for reports
        function saveDailyWellnessData() {
            const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD format
            
            // Get current values from the wellness metrics
            const steps = document.getElementById('todaySteps').value || 0;
            const sleep = document.getElementById('todaySleep').value || 0;
            const mood = document.getElementById('todayMood').value || 0;
            const focus = document.getElementById('todayFocus').value || 0;
            
            // Load existing wellness history
            let wellnessHistory = JSON.parse(localStorage.getItem('wellnessHistory') || '[]');
            
            // Check if today's entry already exists
            const existingEntryIndex = wellnessHistory.findIndex(entry => entry.date === today);
            
            const todayEntry = {
                date: today,
                steps: parseInt(steps) || 0,
                sleep: parseFloat(sleep) || 0,
                mood: parseInt(mood) || 0,
                focus: parseInt(focus) || 0,
                coins: Math.floor((parseInt(steps)/1000) + (parseFloat(sleep)*5) + (parseInt(mood)*5) + (parseInt(focus)/10)) || 0,
                timestamp: new Date().toISOString()
            };
            
            if (existingEntryIndex >= 0) {
                // Update existing entry
                wellnessHistory[existingEntryIndex] = todayEntry;
            } else {
                // Add new entry at the beginning
                wellnessHistory.unshift(todayEntry);
            }
            
            // Keep only last 365 days of data
            wellnessHistory = wellnessHistory.slice(0, 365);
            
            // Save back to localStorage
            localStorage.setItem('wellnessHistory', JSON.stringify(wellnessHistory));
            
            // Update the reports table if it's visible
            if (document.getElementById('reports-tab').classList.contains('active')) {
                loadWellnessDataFromStorage();
                populateWellnessTable();
            }
        }

        function playCoinSound() {
            // Create a simple coin sound using Web Audio API
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.3);
        }

        function animateCoin(event) {
            const coinElement = document.createElement('div');
            coinElement.textContent = 'ª™';
            coinElement.className = 'coin-animation';
            coinElement.style.left = event.pageX + 'px';
            coinElement.style.top = event.pageY + 'px';
            
            document.body.appendChild(coinElement);
            
            setTimeout(() => {
                document.body.removeChild(coinElement);
            }, 2000);
        }

        function animateCoinJar() {
            const jar = document.querySelector('.coin-jar');
            jar.style.animation = 'none';
            setTimeout(() => {
                jar.style.animation = 'float 0.5s ease-in-out';
            }, 10);
            
            playCoinSound();
        }

        // Aura AI interaction
        function interactWithAura() {
            const messages = [
                "🎯 Ready to optimize your wellness? Try updating your daily metrics!",
                "🧠 I've analyzed your focus time - it's excellent today! Maintain this momentum!",
                "🚀 Remember: consistent micro-habits create exponential wellness improvements!",
                "⭐ You're performing exceptionally! Each wellness action optimizes your coin rewards!",
                "🧘 Processing recommendation: Take three deep breaths. Wellness is an algorithmic journey of continuous improvement.",
                "🎮 Have you tried our web-based wellness games? They're excellent for cognitive enhancement!",
                "🔊 Would you like me to provide voice guidance for your wellness activities?"
            ];
            
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            updateAuraMessage(randomMessage);
            
            // Speak the message if voice is enabled
            speakAuraMessage(randomMessage);
            
            // Animate genie
            const avatar = document.querySelector('.genie-avatar');
            avatar.style.transform = 'scale(1.2)';
            setTimeout(() => {
                avatar.style.transform = 'scale(1)';
            }, 300);
        }

        function updateAuraMessage(message) {
            const chatContainer = document.getElementById('genieChat');
            const messageElement = document.createElement('div');
            messageElement.className = 'genie-message';
            messageElement.textContent = message;
            
            chatContainer.appendChild(messageElement);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // Keep only last 5 messages
            const messages = chatContainer.querySelectorAll('.genie-message');
            if (messages.length > 5) {
                chatContainer.removeChild(messages[0]);
            }
        }

        // Voice functionality for Aura
        let auraVoiceEnabled = true;
        let selectedAuraVoice = 'female';

        function speakAuraMessage(message) {
            if (!auraVoiceEnabled || !('speechSynthesis' in window)) return;
            
            // Clean message of emojis for better speech
            const cleanMessage = message.replace(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu, '');
            
            speechSynthesis.cancel(); // Stop any current speech
            
            const utterance = new SpeechSynthesisUtterance(cleanMessage);
            const voices = speechSynthesis.getVoices();
            
            // Select voice based on preference
            if (selectedAuraVoice === 'female') {
                utterance.voice = voices.find(voice => voice.name.toLowerCase().includes('female') || 
                                                      voice.name.toLowerCase().includes('zira')) || voices[0];
                utterance.pitch = 1.1;
            } else if (selectedAuraVoice === 'male') {
                utterance.voice = voices.find(voice => voice.name.toLowerCase().includes('male') || 
                                                      voice.name.toLowerCase().includes('david')) || voices[1] || voices[0];
                utterance.pitch = 0.9;
            } else {
                utterance.voice = voices[0];
                utterance.pitch = 1.0;
            }
            
            utterance.rate = 0.9;
                utterance.volume = 0.7;
                
                speechSynthesis.speak(utterance);
            }
    
            function toggleAuraVoice() {
                auraVoiceEnabled = !auraVoiceEnabled;
                const status = auraVoiceEnabled ? 'enabled' : 'disabled';
                updateAuraMessage(`🔊 Voice feedback ${status}. ${auraVoiceEnabled ? 'I will now speak my responses!' : 'I will only show text responses.'}`);
            }

            // Voice Character System
            let currentCharacter = 'nova';
            
            function selectVoiceCharacter(character) {
                // Remove selection from all cards
                document.querySelectorAll('.voice-character-card').forEach(card => {
                    card.style.border = '3px solid transparent';
                    card.style.transform = 'scale(1)';
                });
                
                // Highlight selected card
                const selectedCard = document.getElementById(character + '-card');
                selectedCard.style.border = '3px solid #fff';
                selectedCard.style.transform = 'scale(1.05)';
                
                // Update character
                currentCharacter = character;
                
                // Update Aura avatar and name
                updateAuraCharacter(character);
                
                // Character-specific messages
                const characterMessages = {
                    nova: "🏃‍♀️ Hi! I'm Nova, your habit tracking companion! I'll help you build consistent wellness routines and celebrate your daily progress!",
                    veda: "💪 Hello! I'm Veda, here to boost your focus and energy! Let's tackle challenges together and maximize your productivity!",
                    kai: "🧘‍♂️ Greetings! I'm Kai, your calm and breath guide. I'll help you find peace, manage stress, and center yourself.",
                    iris: "🌿 Hi there! I'm Iris, your relaxation and recovery specialist. Let's focus on rest, healing, and gentle wellness practices."
                };
                
                updateAuraMessage(characterMessages[character]);
                speakAuraMessage(characterMessages[character]);
                
                // Save selection
                localStorage.setItem('selectedCharacter', character);
            }
            
            function updateAuraCharacter(character) {
                const avatarElement = document.querySelector('.genie-avatar');
                const nameElement = document.getElementById('genieName');
                const roleElement = document.querySelector('.genie-role');
                
                const characterData = {
                    nova: {
                        name: 'Nova',
                        role: 'Habit Tracker Assistant',
                        image: 'nova_orange.png',
                        fallbackEmoji: '🏃‍♀️',
                        color: '#ff8c00'
                    },
                    veda: {
                        name: 'Veda', 
                        role: 'Focus & Energy Coach',
                        image: 'veda_red.png',
                        fallbackEmoji: '💪',
                        color: '#dc143c'
                    },
                    kai: {
                        name: 'Kai',
                        role: 'Calm & Breath Guide', 
                        image: 'kai_blue.png',
                        fallbackEmoji: '🧘‍♂️',
                        color: '#4169e1'
                    },
                    iris: {
                        name: 'Iris',
                        role: 'Relax & Recovery Specialist',
                        image: 'iris_green.png',
                        fallbackEmoji: '🌿', 
                        color: '#228b22'
                    }
                };
                
                const data = characterData[character];
                nameElement.textContent = data.name;
                roleElement.textContent = data.role;
                
                // Update avatar with character image
                avatarElement.innerHTML = `
                    <img src="${data.image}" alt="${data.name}" 
                         style="width: 100%; height: 100%; object-fit: contain; border-radius: 16px; scale: 0.9; padding: 5px;" 
                         onerror="this.outerHTML='<div style=&quot;color: ${data.color}; font-size: 4rem; text-align: center; line-height: 1.2; padding: 20px;&quot;>${data.fallbackEmoji}</div>';">
                `;
            }

            function setAuraVoice(voiceType) {
                selectedAuraVoice = voiceType;
                updateAuraMessage(`🎤 Voice changed to ${voiceType}. Hello! This is how I sound now.`);
                speakAuraMessage(`Voice changed to ${voiceType}. Hello! This is how I sound now.`);
            }

            // Speech Recognition System
            let recognition;
            let isListening = false;
            
            function initializeSpeechRecognition() {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    recognition = new SpeechRecognition();
                    recognition.continuous = false;
                    recognition.interimResults = false;
                    recognition.lang = 'en-US';
                    
                    recognition.onstart = function() {
                        isListening = true;
                        updateSpeechButton(true);
                        updateAuraMessage("🎤 I'm listening... Speak now!");
                    };
                    
                    recognition.onresult = function(event) {
                        const transcript = event.results[0][0].transcript;
                        document.getElementById('genieInput').value = transcript;
                        updateAuraMessage(`🎤 I heard: "${transcript}"`);
                        
                        // Auto-process the speech input
                        setTimeout(() => {
                            const fakeEvent = { key: 'Enter' };
                            handleGenieInput(fakeEvent);
                        }, 1000);
                    };
                    
                    recognition.onerror = function(event) {
                        updateAuraMessage(`🎤 Speech recognition error: ${event.error}`);
                        updateSpeechButton(false);
                        isListening = false;
                    };
                    
                    recognition.onend = function() {
                        isListening = false;
                        updateSpeechButton(false);
                    };
                }
            }
            
            function toggleSpeechRecognition() {
                if (!recognition) {
                    initializeSpeechRecognition();
                }
                
                if (isListening) {
                    recognition.stop();
                    updateAuraMessage("🎤 Stopped listening.");
                } else {
                    if (recognition) {
                        recognition.start();
                    } else {
                        updateAuraMessage("🎤 Speech recognition not supported in your browser. Please use Chrome or Edge.");
                    }
                }
            }
            
            function updateSpeechButton(listening) {
                const button = document.getElementById('speechButton');
                if (listening) {
                    button.style.background = '#dc2626';
                    button.innerHTML = '🔴';
                    button.style.animation = 'pulse 1s infinite';
                } else {
                    button.style.background = '#667eea';
                    button.innerHTML = '🎤';
                    button.style.animation = 'none';
                }
            }

            // Test function for voice in the app
            function testAuraVoiceInApp() {
                const testMessage = "Hello! I'm Aura, your AI wellness assistant. I'm ready to help you achieve your wellness goals through personalized guidance and support.";
                updateAuraMessage("🔊 Testing voice... " + testMessage);
                speakAuraMessage(testMessage);
        }

        // Maintain backward compatibility
        function updateGenieMessage(message) {
            updateAuraMessage(message);
            speakAuraMessage(message);
        }

        function handleGenieInput(event) {
            if (event.key === 'Enter') {
                const input = document.getElementById('genieInput');
                const userMessage = input.value.trim();
                
                if (userMessage) {
                    // Add user message
                    const chatContainer = document.getElementById('genieChat');
                    const userMsgElement = document.createElement('div');
                    userMsgElement.className = 'genie-message';
                    userMsgElement.style.background = 'rgba(255, 255, 255, 0.3)';
                    userMsgElement.textContent = 'You: ' + userMessage;
                    chatContainer.appendChild(userMsgElement);
                    
                    // Generate genie response based on AI Coaching Pillars
                    const response = generateGenieResponse(userMessage);
                    setTimeout(() => {
                        updateGenieMessage(response);
                    }, 1000);
                    
                    input.value = '';
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                }
            }
        }

        function generateGenieResponse(userInput) {
            const lowerInput = userInput.toLowerCase();
            
            // Based on AI_Coaching_Pillars_Guide.md
            if (lowerInput.includes('stress') || lowerInput.includes('anxious')) {
                return "🧘 I understand you're feeling stressed. Try the 4-7-8 breathing technique: inhale for 4 counts, hold for 7, exhale for 8. This activates your parasympathetic nervous system for instant calm.";
            } else if (lowerInput.includes('sleep') || lowerInput.includes('tired')) {
                return "😴 Sleep is crucial for recovery! Aim for 7-9 hours. Try creating a wind-down ritual: dim lights 1 hour before bed, no screens 30 minutes prior, and practice gratitude breathing.";
            } else if (lowerInput.includes('focus') || lowerInput.includes('concentrate')) {
                return "🎯 Let's optimize your focus! Try the Pomodoro Technique: 25-minute deep work blocks with 5-minute breaks. Eliminate distractions and single-task for better quality output.";
            } else if (lowerInput.includes('exercise') || lowerInput.includes('movement')) {
                return "🏃 Movement is medicine! Aim for 8,000-10,000 steps daily. For game developers, take desk breaks every 30 minutes and try the 20-20-20 rule for eye health.";
            } else if (lowerInput.includes('goal') || lowerInput.includes('motivation')) {
                return "🎯 Let's set SMART goals! Make them Specific, Measurable, Achievable, Relevant, and Time-bound. Break big goals into daily actions and celebrate small wins!";
            } else if (lowerInput.includes('food') || lowerInput.includes('nutrition')) {
                return "🥗 Fuel your body right! Aim for 50% vegetables/fruits, 25% lean proteins, 25% whole grains. Stay hydrated with 8-10 glasses of water daily!";
            } else {
                const genericResponses = [
                    "✨ That's a great question! Remember, wellness is about small, consistent actions that compound over time.",
                    "🌟 I'm here to support your wellness journey! What specific area would you like to focus on - physical, mental, productivity, social, or purpose?",
                    "💪 Every step you take towards wellness is valuable. Which of the five pillars resonates most with you right now?",
                    "🎯 Your wellness journey is unique to you. What feels most important for your well-being today?"
                ];
                return genericResponses[Math.floor(Math.random() * genericResponses.length)];
            }
        }

        // Game functions
        function openSnakeGame() {
            updateGenieMessage("🐍 Snake game coming up! This classic game improves focus and reaction time. Great for cognitive wellness!");
            addCoins(50, event);
            openWebGame('games/wellness_snake.html');
        }

        // Web Game Integration Function
        function openWebGame(gameUrl) {
            const gameName = gameUrl.includes('snake') ? 'Wellness Snake' :
                           gameUrl.includes('memory') ? 'Memory Cards' :
                           gameUrl.includes('sudoku') ? 'Sudoku Puzzle' :
                           gameUrl.includes('zen') ? 'Zen Garden' :
                           gameUrl.includes('index') ? 'Game Hub' : 'Wellness Game';
            
            const messages = {
                'Wellness Snake': "🐍 Snake game coming up! This classic game improves focus and reaction time. Great for cognitive wellness!",
                'Memory Cards': "🧠 Memory games are fantastic for cognitive health! They strengthen neural pathways and improve concentration.",
                'Sudoku Puzzle': "🧩 Sudoku is excellent for logical thinking and mental clarity. Perfect for developers!",
                'Zen Garden': "🌸 Zen garden creation is perfect for mindfulness and stress reduction. Let creativity flow!",
                'Game Hub': "🎮 Access all wellness games in one convenient hub with progress tracking!"
            };
            
            updateGenieMessage(messages[gameName] || "🎯 Enjoy this wellness game for better mental health!");
            
            // Open game in new window
            const gameWindow = window.open(gameUrl, '_blank', 'width=800,height=600,scrollbars=yes,resizable=yes');
            
            if (gameWindow) {
                // Listen for coin messages from games
                window.addEventListener('message', function(event) {
                    if (event.data && event.data.type === 'addCoins') {
                        addCoins(event.data.amount, null);
                        updateGenieMessage(`🪙 Great job! You earned ${event.data.amount} wellness coins from ${gameName}!`);
                    }
                });
                
                gameWindow.focus();
            } else {
                alert('Please allow popups to play the games, or navigate to: ' + gameUrl);
            }
        }

        // Data export functions
        function downloadCSV() {
            const days = parseInt(document.getElementById('dayCount').value) || 30;
            const csvData = generateSampleData(days);
            downloadFile(csvData, 'ea_aura_wellness_data_' + days + 'days.csv', 'text/csv');
            addCoins(20, event);
            updateGenieMessage('📊 Great! Downloaded ' + days + ' days of wellness data. Regular tracking helps identify patterns and progress!');
        }

        function downloadPDF() {
            updateGenieMessage("📄 PDF report feature coming soon! This will include comprehensive wellness analytics and insights.");
            addCoins(15, event);
        }

        function downloadJSON() {
            const data = {
                exportDate: new Date().toISOString(),
                user: "EA Employee",
                wellness_data: {
                    current_metrics: {
                        steps: parseInt(document.getElementById('todaySteps').value),
                        sleep: parseFloat(document.getElementById('todaySleep').value),
                        mood: parseInt(document.getElementById('todayMood').value),
                        focus: parseInt(document.getElementById('todayFocus').value)
                    },
                    coins: {
                        total: currentCoins,
                        today: todayCoins,
                        weekly: weeklyCoins
                    }
                }
            };
            
            downloadFile(JSON.stringify(data, null, 2), 'ea_aura_wellness_data.json', 'application/json');
        }

                function downloadExcelTemplate() {
            // Show information modal for the comprehensive Excel file
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); display: flex; justify-content: center;
                align-items: center; z-index: 1000; padding: 20px; box-sizing: border-box;
            `;
            
            modal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 20px; max-width: 600px; max-height: 90vh; overflow-y: auto; position: relative;">
                    <button onclick="document.body.removeChild(this.parentElement.parentElement)" 
                            style="position: absolute; top: 15px; right: 15px; background: #f44336; color: white; 
                                   border: none; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; font-size: 16px;">×</button>
                    
                    <h2 style="color: #007acc; margin-bottom: 25px; text-align: center;">📊 EA Financial Wellness Excel Template</h2>
                    
                    <div style="background: #e8f5e8; padding: 20px; border-radius: 12px; margin-bottom: 25px;">
                        <h4 style="color: #28a745; margin-bottom: 15px; text-align: center;">📋 Complete Excel Workbook Features:</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; font-size: 0.9rem;">
                            <div>✅ Income Tracking Sheet</div>
                            <div>✅ Expense Analysis Sheet</div>
                            <div>✅ Investment Portfolio Sheet</div>
                            <div>✅ Financial Goals Sheet</div>
                            <div>✅ Health Ratios Sheet</div>
                            <div>✅ Budget Allocation Sheet</div>
                            <div>✅ Financial Tips Sheet</div>
                            <div>✅ Auto-calculating Formulas</div>
                        </div>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 25px; border: 2px solid #007acc;">
                        <h4 style="color: #007acc; margin-bottom: 10px; text-align: center;">🎯 Professional Template Benefits</h4>
                        <ul style="color: #555; margin-left: 20px; line-height: 1.8; list-style: none;">
                            <li>💡 <strong>50/30/20 Budget Framework</strong> - Proven allocation strategy</li>
                            <li>🔢 <strong>Automated Calculations</strong> - No manual math required</li>
                            <li>🎨 <strong>Professional Formatting</strong> - Ready for presentations</li>
                            <li>📝 <strong>Sample Data Included</strong> - Easy to understand and customize</li>
                        </ul>
                    </div>
                    
                    <div style="text-align: center; margin-bottom: 20px;">
                        <a href="EA_Aura_Financial_Health.xlsx" download 
                           style="background: linear-gradient(45deg, #007acc, #0099cc); color: white; text-decoration: none; padding: 18px 40px; 
                                  border-radius: 30px; font-size: 18px; display: inline-block; font-weight: bold; 
                                  box-shadow: 0 4px 12px rgba(0,122,204,0.3); transition: all 0.3s ease;"
                           onclick="document.body.removeChild(this.parentElement.parentElement.parentElement)"
                           onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 16px rgba(0,122,204,0.4)'"
                           onmouseout="this.style.transform='translateY(0px)'; this.style.boxShadow='0 4px 12px rgba(0,122,204,0.3)'">
                            📊 Download Excel Template
                        </a>
                    </div>
                    
                    <div style="font-size: 0.9rem; color: #555; text-align: center; line-height: 1.6; background: #f0f8ff; padding: 15px; border-radius: 8px;">
                        <strong>🚀 Ready to use professional Excel template</strong><br>
                        Advanced formulas • Multiple worksheets • Conditional formatting<br>
                        Professional charts • Budget frameworks • Financial guidance
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Award coins for accessing financial planning tools
            addCoins(35, event);
            updateAuraMessage("📊 Excellent! Accessing EA Aura Financial Health Excel template. This comprehensive workbook includes multiple worksheets with advanced formulas and professional formatting!");
        }

        function downloadExcelCSV() {
            // Create the comprehensive Excel-compatible CSV content for fallback
            const excelContent = `EA Aura Financial Health Workbook - Complete Financial Analysis

INCOME SUMMARY,,,,
Income Category,Monthly Amount,Annual Amount,Notes
Base Salary,7500,90000,Primary employment income
Bonus/Incentives,1000,12000,Performance-based rewards
Side Projects,500,6000,Freelance or consulting work
Investment Returns,300,3600,Dividends and interest
Other Income,200,2400,Miscellaneous income sources

EXPENSE BREAKDOWN,,,,
Expense Category,Monthly Amount,Annual Amount,Budget %,Notes
Housing (Rent/EMI),3800,45600,40.0%,Rent or mortgage payments
Utilities & Bills,400,4800,4.2%,Electricity water internet phone
Transportation,600,7200,6.3%,Fuel public transport maintenance
Food & Groceries,1200,14400,12.6%,Daily meals and household items
Healthcare,300,3600,3.2%,Medical insurance checkups
Entertainment,400,4800,4.2%,Movies dining out hobbies

INVESTMENT ALLOCATION,,,,
Investment Type,Monthly Amount,Annual Amount,Risk Level,Expected Return
PPF/EPF,1000,12000,Low,7-8%
Mutual Funds SIP,800,9600,Medium,10-12%
Stocks/Equity,400,4800,High,12-15%
Fixed Deposits,200,2400,Low,5-6%

FINANCIAL GOALS TRACKING,,,,
Financial Goal,Target Amount,Time Frame,Monthly Required,Progress
Emergency Fund,50000,12 months,4167,25%
Home Down Payment,500000,60 months,8333,10%
Retirement Corpus,5000000,360 months,2778,5%

BUDGET ALLOCATION (50/20/20/10 RULE),,,,
Category,Recommended %,Recommended Amount,Current Amount,Variance
Needs (Essential),50%,4750,5400,-650
Wants (Lifestyle),20%,1900,1400,500
Savings,20%,1900,1500,400
Investments,10%,950,1200,-250

Generated by EA Aura Wellness Hub - Financial Health Module`;

            // Create and download the CSV file
            downloadFile(excelContent, 'EA_Aura_Financial_Health_Backup.csv', 'text/csv');
            updateAuraMessage("📊 CSV version downloaded successfully! This backup version contains all the essential financial data and can be opened in any spreadsheet application.");
        }

        // Update progress bars based on input values
        function updateProgressBars() {
            const steps = parseInt(document.getElementById('todaySteps').value) || 0;
            const sleep = parseFloat(document.getElementById('todaySleep').value) || 0;
            const mood = parseInt(document.getElementById('todayMood').value) || 0;
            const focus = parseInt(document.getElementById('todayFocus').value) || 0;

            document.getElementById('stepsProgress').style.width = Math.min(100, (steps / 10000) * 100) + '%';
            document.getElementById('sleepProgress').style.width = Math.min(100, (sleep / 9) * 100) + '%';
            document.getElementById('moodProgress').style.width = (mood / 10) * 100 + '%';
            document.getElementById('focusProgress').style.width = Math.min(100, (focus / 200) * 100) + '%';
        }

        // Initialize daily quote
        function setDailyQuote() {
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);
            const quoteIndex = dayOfYear % dailyQuotes.length;
            document.getElementById('dailyQuote').textContent = '"' + dailyQuotes[quoteIndex] + '"';
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Setup metric input listeners
            document.querySelectorAll('.metric-value').forEach(input => {
                input.addEventListener('input', updateProgressBars);
                input.addEventListener('blur', updateProgressBars);
            });

            // Initial progress bar update
            updateProgressBars();

            // Set daily quote
            setDailyQuote();

            // Welcome message from genie
            setTimeout(() => {
                updateGenieMessage("🌟 Welcome to EA Aura Enhanced! I've been trained on comprehensive wellness coaching principles. Click any metric to earn coins and improve your wellness!");
            }, 2000);
        });

        // ===== WELLNESS DATA & REPORTS FUNCTIONALITY =====
        
        let wellnessHistoryData = [];

        // Load wellness data from localStorage or create sample data if none exists
        function loadWellnessDataFromStorage() {
            const savedData = localStorage.getItem('wellnessHistory');
            
            if (savedData) {
                wellnessHistoryData = JSON.parse(savedData);
            } else {
                // Sample wellness data for demonstration (first time users)
                wellnessHistoryData = [
                    {date: '2025-11-13', steps: 8247, sleep: 7.2, mood: 9, focus: 145, coins: 50},
                    {date: '2025-11-12', steps: 9834, sleep: 8.1, mood: 8, focus: 180, coins: 65},
                    {date: '2025-11-11', steps: 7654, sleep: 6.8, mood: 7, focus: 120, coins: 40},
                    {date: '2025-11-10', steps: 10245, sleep: 7.5, mood: 9, focus: 200, coins: 70},
                    {date: '2025-11-09', steps: 6789, sleep: 7.0, mood: 6, focus: 90, coins: 35},
                    {date: '2025-11-08', steps: 11250, sleep: 8.2, mood: 10, focus: 240, coins: 80},
                    {date: '2025-11-07', steps: 8932, sleep: 7.8, mood: 8, focus: 165, coins: 55},
                    {date: '2025-11-06', steps: 7456, sleep: 6.5, mood: 7, focus: 110, coins: 38},
                    {date: '2025-11-05', steps: 9678, sleep: 7.9, mood: 9, focus: 195, coins: 68},
                    {date: '2025-11-04', steps: 8123, sleep: 7.3, mood: 8, focus: 150, coins: 52}
                ];
                // Save sample data to localStorage for consistency
                localStorage.setItem('wellnessHistory', JSON.stringify(wellnessHistoryData));
            }
        }

        function populateWellnessTable(days = 30) {
            const tableBody = document.getElementById('wellnessTableBody');
            const filteredData = wellnessHistoryData.slice(0, Math.min(days === 'all' ? wellnessHistoryData.length : days, wellnessHistoryData.length));
            
            if (filteredData.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="6" style="padding: 20px; text-align: center; color: #666; font-style: italic;">No wellness data available for the selected period.</td></tr>';
                return;
            }

            tableBody.innerHTML = filteredData.map(entry => {
                const moodColor = entry.mood >= 8 ? '#28a745' : entry.mood >= 6 ? '#ffc107' : '#dc3545';
                const stepsColor = entry.steps >= 8000 ? '#28a745' : entry.steps >= 5000 ? '#ffc107' : '#dc3545';
                const sleepColor = entry.sleep >= 7 ? '#28a745' : entry.sleep >= 6 ? '#ffc107' : '#dc3545';
                const focusColor = entry.focus >= 120 ? '#28a745' : entry.focus >= 60 ? '#ffc107' : '#dc3545';
                
                return `
                    <tr style="border-bottom: 1px solid #dee2e6; transition: all 0.2s ease;" onmouseover="this.style.backgroundColor='#f8f9fa'" onmouseout="this.style.backgroundColor='white'">
                        <td style="padding: 12px; border: 1px solid #dee2e6; font-weight: 500;">${new Date(entry.date).toLocaleDateString()}</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6; text-align: center; color: ${stepsColor}; font-weight: 500;">${entry.steps.toLocaleString()}</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6; text-align: center; color: ${sleepColor}; font-weight: 500;">${entry.sleep}</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6; text-align: center; color: ${moodColor}; font-weight: 500;">${entry.mood}/10</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6; text-align: center; color: ${focusColor}; font-weight: 500;">${entry.focus}</td>
                        <td style="padding: 12px; border: 1px solid #dee2e6; text-align: center; font-weight: 500; color: #f39c12;">${entry.coins}</td>
                    </tr>
                `;
            }).join('');

            updateSummaryStats(filteredData);
        }

        function updateSummaryStats(data) {
            if (data.length === 0) return;

            const avgSteps = Math.round(data.reduce((sum, entry) => sum + entry.steps, 0) / data.length);
            const avgSleep = (data.reduce((sum, entry) => sum + entry.sleep, 0) / data.length).toFixed(1);
            const avgMood = (data.reduce((sum, entry) => sum + entry.mood, 0) / data.length).toFixed(1);
            const avgFocus = Math.round(data.reduce((sum, entry) => sum + entry.focus, 0) / data.length);

            document.getElementById('avgSteps').textContent = avgSteps.toLocaleString();
            document.getElementById('avgSleep').textContent = avgSleep + ' hrs';
            document.getElementById('avgMood').textContent = avgMood + '/10';
            document.getElementById('avgFocus').textContent = avgFocus + ' min';

            // Goal achievement rates (assuming goals: 8000 steps, 7 hrs sleep, mood 7+, 120 min focus)
            const stepsGoal = Math.round((data.filter(e => e.steps >= 8000).length / data.length) * 100);
            const sleepGoal = Math.round((data.filter(e => e.sleep >= 7).length / data.length) * 100);
            const moodGoal = Math.round((data.filter(e => e.mood >= 7).length / data.length) * 100);
            const focusGoal = Math.round((data.filter(e => e.focus >= 120).length / data.length) * 100);

            document.getElementById('stepsGoalRate').textContent = stepsGoal + '%';
            document.getElementById('sleepGoalRate').textContent = sleepGoal + '%';
            document.getElementById('moodGoalRate').textContent = moodGoal + '%';
            document.getElementById('focusGoalRate').textContent = focusGoal + '%';

            // Personal records
            const maxSteps = Math.max(...data.map(e => e.steps));
            const maxSleep = Math.max(...data.map(e => e.sleep));
            const maxMood = Math.max(...data.map(e => e.mood));
            const maxFocus = Math.max(...data.map(e => e.focus));

            document.getElementById('maxSteps').textContent = maxSteps.toLocaleString();
            document.getElementById('maxSleep').textContent = maxSleep + ' hrs';
            document.getElementById('maxMood').textContent = maxMood + '/10';
            document.getElementById('maxFocus').textContent = maxFocus + ' min';
        }

        function filterWellnessData() {
            const filterValue = document.getElementById('wellnessTimeFilter').value;
            const days = filterValue === 'all' ? 'all' : parseInt(filterValue);
            populateWellnessTable(days);
        }

        function refreshWellnessData() {
            // Simulate refreshing data - in real app, this would fetch from server/localStorage
            updateAuraMessage("📊 Refreshing wellness data... Your tracking history is up to date!");
            populateWellnessTable();
        }

        // ===== DOWNLOAD FUNCTIONALITY =====

        function downloadWellnessCSV() {
            const csvContent = [
                ['Date', 'Steps', 'Sleep (hours)', 'Mood (1-10)', 'Focus (minutes)', 'Coins Earned'],
                ...wellnessHistoryData.map(entry => [
                    entry.date,
                    entry.steps,
                    entry.sleep,
                    entry.mood,
                    entry.focus,
                    entry.coins
                ])
            ].map(row => row.join(',')).join('\n');

            downloadFile(csvContent, 'ea_wellness_data.csv', 'text/csv');
            updateAuraMessage("📊 Wellness data exported successfully! Use this for tracking trends or sharing with healthcare providers.");
            addCoins(25, null);
        }

        function downloadJournalCSV() {
            const journalEntries = JSON.parse(localStorage.getItem('journalEntries') || '[]');
            
            if (journalEntries.length === 0) {
                updateAuraMessage("📝 No journal entries found to export. Start journaling to build your personal wellness record!");
                return;
            }

            const csvContent = [
                ['Date', 'Mood', 'Gratitude 1', 'Gratitude 2', 'Gratitude 3', 'Wins', 'Lessons', 'Tomorrow Focus'],
                ...journalEntries.map(entry => [
                    entry.date,
                    entry.mood,
                    entry.gratitude[0] || '',
                    entry.gratitude[1] || '',
                    entry.gratitude[2] || '',
                    entry.reflections.win || '',
                    entry.reflections.lesson || '',
                    entry.reflections.focus || ''
                ])
            ].map(row => row.map(cell => `"${(cell || '').toString().replace(/"/g, '""')}"`).join(',')).join('\n');

            downloadFile(csvContent, 'ea_journal_entries.csv', 'text/csv');
            updateAuraMessage(`📝 ${journalEntries.length} journal entries exported successfully! Your personal growth journey is documented.`);
            addCoins(30, null);
        }



        function downloadFile(content, filename, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }

        // Initialize wellness table when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Small delay to ensure DOM is ready
            setTimeout(() => {
                loadWellnessDataFromStorage();
                populateWellnessTable();
                
                // Add event listeners to wellness inputs for auto-save
                const inputs = ['todaySteps', 'todaySleep', 'todayMood', 'todayFocus'];
                inputs.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.addEventListener('blur', () => {
                            saveDailyWellnessData();
                            updateAuraMessage("💾 Your wellness data has been automatically saved to your reports!");
                        });
                        element.addEventListener('change', () => {
                            saveDailyWellnessData();
                        });
                    }
                });
            }, 100);
        });
    </script>
</body>
</html>